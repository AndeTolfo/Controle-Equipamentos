-----------Compras------------------
CREATE TABLE Compras(
    COD_COMPRA INTEGER NOT NULL,
    DATA_COMPRA DATE,
    NOME_ITEM VARCHAR(200),
    LOJA_COMPRA VARCHAR(200),
    N_PEDIDO VARCHAR(100), 
    NOME_COMPRADOR VARCHAR(100),
    VALOR_ITEM DECIMAL(15,2),
    ORIGEM_COMPRA VARCHAR(1),
    QTD_Comprada Decimal(15,2),
    TOTAL DECIMAL(15,2)   
);


ALTER TABLE COMPRAS
ADD CONSTRAINT PK_COMPRAS
PRIMARY KEY (COD_COMPRA);

CREATE SEQUENCE GEN_COMPRA;

CREATE TRIGGER COMPRAS_BI FOR COMPRAS
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
 IF(NEW.COD_COMPRA IS NULL) THEN
  NEW.COD_COMPRA = GEN_ID(GEN_COMPRA, 1);
END;

---------------------Funcionario-----------------------------
CREATE TABLE FUNCIONARIOS(
    COD_FUNCIONARIO INTEGER NOT NULL,
    NOME_FUNCIONARIO VARCHAR(200),
    SETOR VARCHAR(50),
    STATUS VARCHAR(20),
    DATA_CADASTRO DATE
);

ALTER TABLE FUNCIONARIOS
ADD CONSTRAINT PK_FUNCIONARIO
PRIMARY KEY (COD_FUNCIONARIO);

CREATE SEQUENCE GEN_FUNCIONARIO;

CREATE TRIGGER FUNCIONARIO_BI FOR FUNCIONARIOS
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
 IF(NEW.COD_FUNCIONARIO IS NULL) THEN
  NEW.COD_FUNCIONARIO = GEN_ID(GEN_FUNCIONARIO, 1);
END;

-------------MAQUINAS INTERNAS--------------------
CREATE TABLE EQUIPAMENTOS_INTERNOS(
    COD_EQP INTEGER NOT NULL,
    DATA_CADASTRO DATE,
    DATA_ATUALIZACAO TIMESTAMP,
    NOME_MAQUINA VARCHAR(200),
    IP VARCHAR(20),
    PROCESSADOR VARCHAR(100),
    RAM VARCHAR(10),
    PLACA_MAE VARCHAR(100),
    HD_SSD VARCHAR(100),
    WINDOWS VARCHAR(50),
    LICENSA VARCHAR(100),
    SETOR VARCHAR(50),
    COD_FUNCIONARIO INTEGER              
);


ALTER TABLE EQUIPAMENTOS_INTERNOS
ADD CONSTRAINT PK_EQP
PRIMARY KEY (COD_EQP);

CREATE SEQUENCE GEN_EQP;

CREATE TRIGGER EQUIPAMENTOS_BI FOR EQUIPAMENTOS_INTERNOS
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
 IF(NEW.COD_EQP IS NULL) THEN
  NEW.COD_EQP = GEN_ID(GEN_EQP, 1);
END;

ALTER TABLE Equipamentos_Internos
ADD CONSTRAINT FK_Equipamentos_Funcionario
 FOREIGN KEY(COD_Funcionario)
 REFERENCES Funcionarios(COD_FUNCIONARIO)
 ON UPDATE CASCADE;

---------------HIST M√ÅQUINAS---------------------
CREATE TABLE HIST_MAQUINAS(
     COD_HIST INTEGER NOT NULL,
     COD_MAQUINA INTEGER NOT NULL,
     COD_FUNCIONARIO INTEGER NOT NULL,
     DT_HISTORICO TIMESTAMP,
     DT_Atribuicao TIMESTAMP,
     DT_Devolucao TIMESTAMP            
);

ALTER TABLE HIST_MAQUINAS
ADD CONSTRAINT PK_HIST
PRIMARY KEY (COD_HIST);

CREATE SEQUENCE GEN_HIST;

CREATE TRIGGER HIST_BI FOR HIST_MAQUINAS
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
 IF(NEW.COD_HIST IS NULL) THEN
  NEW.COD_HIST = GEN_ID(GEN_HIST, 1);
END;

ALTER TABLE HIST_MAQUINAS
ADD CONSTRAINT FK_COD_MAQ
 FOREIGN KEY(COD_MAQUINA)
 REFERENCES EQUIPAMENTOS_INTERNOS(COD_EQP)
 ON UPDATE CASCADE;

ALTER TABLE HIST_MAQUINAS
ADD CONSTRAINT FK_COD_FUNCIONARIO
 FOREIGN KEY(COD_FUNCIONARIO)
 REFERENCES FUNCIONARIOS(COD_FUNCIONARIO)
 ON UPDATE CASCADE;








